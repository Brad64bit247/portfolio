<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ol{margin:0;padding:0}table td,table th{padding:0}.c14{-webkit-text-decoration-skip:none;color:#000000;font-weight:400;text-decoration:underline;vertical-align:baseline;text-decoration-skip-ink:none;font-size:26pt;font-family:"Arial";font-style:normal}.c1{margin-left:30pt;padding-top:12pt;padding-bottom:12pt;line-height:1.15;orphans:2;widows:2;text-align:center;margin-right:30pt}.c9{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:italic}.c18{color:#434343;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:"Arial";font-style:normal}.c7{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Times New Roman";font-style:normal}.c6{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:16pt;font-family:"Arial";font-style:normal}.c4{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c11{padding-top:18pt;text-indent:36pt;padding-bottom:6pt;line-height:1.15;orphans:2;widows:2;text-align:center}.c12{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c16{color:#000000;text-decoration:none;vertical-align:baseline;font-size:16pt;font-family:"Arial";font-style:normal}.c0{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:center}.c2{padding-top:12pt;padding-bottom:12pt;line-height:1.15;orphans:2;widows:2;text-align:center}.c15{padding-top:0pt;padding-bottom:3pt;line-height:1.15;orphans:2;widows:2;text-align:center}.c8{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c10{page-break-after:avoid}.c17{height:16pt}.c5{font-weight:700}.c3{height:11pt}.c13{text-indent:36pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c8 doc-content"><p class="c10 c15 title" id="h.wqlk6483fr09"><span class="c14">&nbsp;Try Hack Me [Day 2] Web Exploitation The Elf Strikes Back!</span></p><p class="c3 c12"><span class="c4"></span></p><p class="c0"><span class="c4">This room covers the basics of infiltrating a website and launching an uploaded reverse shell. It includes on the step involved in this process.</span></p><hr><p class="c0 c3"><span class="c4"></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 54.67px;"><img alt="" src="images/image10.png" style="width: 624.00px; height: 54.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span class="c4">After your heroic deeds regaining control of the control centre yesterday, Elf McSkidy has decided to give you an important job to do.</span></p><p class="c2"><span class="c4">&quot;We know we&#39;ve been hacked, so we need a way to protect ourselves! The dev team have set up a website for the elves to upload pictures of any suspicious people hanging around the factory, but we need to make sure it&#39;s secure before we add it to the public network. Please perform a security audit on the new server and make sure it&#39;s unhackable!&quot;</span></p><p class="c2"><span>You listen to the briefing and accept the task, </span><span class="c5">pressing the deploy button to start the server</span><span class="c4">&nbsp;as you do so.</span></p><p class="c2"><span class="c4">McSkidy once again gives you a dossier of useful information to help you with your task, which you read as you wait for the server to boot:</span></p><p class="c2"><span class="c9">At the bottom of the dossier is a sticky note containing the following message:</span></p><p class="c1"><span class="c4">For Elf McEager:</span></p><p class="c1"><span>You have been assigned an ID number for your audit of the system: </span><span class="c5">ODIzODI5MTNiYmYw</span><span class="c4">&nbsp;. Use this to gain access to the upload section of the site.</span></p><p class="c1"><span class="c4">Good luck!</span></p><hr><p class="c2 c3"><span class="c4"></span></p><h2 class="c2 c10" id="h.db5hifo0mh6g"><span class="c6">Question 1: What string of text needs adding to the URL to get access to the upload page?</span></h2><p class="c2"><span class="c4">I&rsquo;m going to start by visiting the box using my browser</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 656.34px; height: 369.68px;"><img alt="" src="images/image7.png" style="width: 656.34px; height: 369.68px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span>You can see that is wants us to put in the code we were assigned earlier. </span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 429.00px; height: 29.00px;"><img alt="" src="images/image4.png" style="width: 429.00px; height: 29.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><hr><p class="c2 c3"><span class="c4"></span></p><p class="c2 c3"><span class="c4"></span></p><h3 class="c2 c10" id="h.bc3m9k1gqozk"><span class="c18">Question 2: What type of file is accepted by the site?</span></h3><h2 class="c2 c10 c17" id="h.b1fmnj9rrwur"><span class="c5 c16"></span></h2><p class="c2"><span class="c4">After typing the boxes ip and id into the browsers address bar this page loads. When I click on the page a box appears.ars that asks for an upload.</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 739.64px; height: 397.08px;"><img alt="" src="images/image6.png" style="width: 739.64px; height: 397.08px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><hr><p class="c2 c3"><span class="c4"></span></p><p class="c2"><span class="c4">Bypass the filter and upload a reverse shell.</span></p><p class="c2"><span class="c4">In which directory are the uploaded files stored?</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 250.67px;"><img alt="" src="images/image8.png" style="width: 624.00px; height: 250.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c3"><span class="c4"></span></p><p class="c0"><span class="c4">More than likely they have some type of filter for stopping uploads of files that are not images. types. However there is a trick called a double barrelled extension that I&rsquo;ve seen for these types of situations.</span></p><p class="c0 c3"><span class="c4"></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 297.00px; height: 205.00px;"><img alt="" src="images/image1.png" style="width: 297.00px; height: 205.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c3"><span class="c4"></span></p><p class="c0"><span>If you look closely you will notice the top two files might look weird. I have placed the </span><span class="c5">.jpg</span><span>&nbsp;and </span><span class="c5">.png image file extensions</span><span class="c4">&nbsp;in front of the actual file type. This will trick the websites filter and let us in. A shell allows someone to interface with a computer. These files when opened on another computer will give us access into that computer. After configuring the shell &nbsp;to connect to me I upload it into the computer</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 349.00px; height: 186.00px;"><img alt="" src="images/image5.png" style="width: 349.00px; height: 186.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><hr></p><p class="c0 c3 c13"><span class="c7"></span></p><h2 class="c10 c11" id="h.j29d1epiwb28"><span class="c6">Activate your reverse shell and catch it in a netcat listener!</span></h2><p class="c0 c3"><span class="c4"></span></p><p class="c0"><span>We have to find a way to launch that file on the server. There are a few ways to go about this but the easiest would be to scan the directory using a tool like </span><span class="c5">dirbuster. </span><span class="c4">Before I do that I&rsquo;m going to try some common destinations that people save uploads to. </span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 256.00px;"><img alt="" src="images/image9.png" style="width: 624.00px; height: 256.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c4">On the first try I got in by pointing the url to the uploads folder on the server. There is our shell sitting and waiting for us. Before we click it we have to prepare our computer to receive the shells signal.</span></p><p class="c0 c3"><span class="c4"></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 251.00px; height: 72.00px;"><img alt="" src="images/image3.png" style="width: 251.00px; height: 72.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c3"><span class="c4"></span></p><p class="c0"><span class="c4">Using Netcat we can catch our shell</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 254.67px;"><img alt="" src="images/image11.png" style="width: 624.00px; height: 254.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span>.</span><hr></p><p class="c0 c3"><span class="c7"></span></p><h2 class="c2 c10" id="h.n6us62ycomd3"><span class="c6">What is the flag in /var/www/flag.txt?</span></h2><hr><h2 class="c2 c10 c17" id="h.dkt7hb4j1b6f"><span class="c7"></span></h2><h2 class="c2 c10" id="h.fr93247wecaq"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 316.00px;"><img alt="" src="images/image2.png" style="width: 624.00px; height: 316.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></h2><p class="c0"><span>Now that we have a shell we can access the servers files. We can dump out the text from that file with the cat command and now we have our flag. </span></p></body></html>